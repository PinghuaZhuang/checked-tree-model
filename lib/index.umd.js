var L=Object.defineProperty;var E=(s,h,r)=>h in s?L(s,h,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[h]=r;var d=(s,h,r)=>(E(s,typeof h!="symbol"?h+"":h,r),r),g=(s,h,r)=>{if(!h.has(s))throw TypeError("Cannot "+r)};var f=(s,h,r)=>(g(s,h,"read from private field"),r?r.call(s):h.get(s)),o=(s,h,r)=>{if(h.has(s))throw TypeError("Cannot add the same private member more than once");h instanceof WeakSet?h.add(s):h.set(s,r)},a=(s,h,r,c)=>(g(s,h,"write to private field"),c?c.call(s,r):h.set(s,r),r);(function(s,h){typeof exports=="object"&&typeof module<"u"?module.exports=h():typeof define=="function"&&define.amd?define(h):(s=typeof globalThis<"u"?globalThis:s||self,s.CheckedTreeModel=h())})(this,function(){var c,u,l,m;"use strict";let s={};function h(k,...e){e.forEach(t=>{var i;for(const n in t){const p=t[n];p!==null&&(typeof p!="object"?k[n]=p:(k[n]=(i=k[n])!=null?i:{},h(k[n],p)))}})}const I=class{constructor(e,t){o(this,c,!1);o(this,u,!1);o(this,l,!1);o(this,m,!1);d(this,"id");d(this,"pId");d(this,"level");d(this,"options");d(this,"name");d(this,"childList");d(this,"parent");d(this,"className");d(this,"map");this.options=Object.assign({},e),this.name=e.name,this.className=e.className,this.id=e.id,this.pId=e.pId,this.parent=t,this.level=t==null?0:t.level+1,this.map=t==null?{[this.id]:this}:t.map,this.childList=e.childList.map(i=>{const n=new I(i,this);return this.map[n.id]!=null&&console.warn(`the same id. id: ${n.id}`),this.map[n.id]=n,n})}isRoot(){return this.level===0}get checked(){return f(this,c)}get indeterminate(){return f(this,l)}diff(){let e=s[this.id];return f(this,u)!==f(this,c)&&(e=e!=null?e:{},e.checked=f(this,c),f(this,c)&&(e.indeterminate=!1)),f(this,m)!==f(this,l)&&(e=e!=null?e:{},e.indeterminate=f(this,l)),e&&(s[this.id]=e),e}setChecked(e,t,i){return a(this,u,f(this,c)),a(this,c,e),e&&this.setIndeterminate(!1,!0),this.diff()&&this.parent&&!t&&this.calcParentStatus(),i||(e?this.each(n=>{n.setIndeterminate(!1,!0),n.setChecked(!0,!0)}):this.indeterminate||this.each(n=>{n.setIndeterminate(!1,!0),n.setChecked(!1,!0)})),this}setIndeterminate(e,t){return a(this,m,f(this,l)),a(this,l,e),e&&!t&&(a(this,u,f(this,c)),a(this,c,!1),this.parent&&this.parent.setIndeterminate(!0)),t||this.diff(),this}setCheckedByIdReturnDiff(e,t,i){s={};const n=this.map[e!=null?e:this.id];if(n==null)return{};n.setChecked(t!=null?t:!0,!1,i);const p=Object.assign({},s);return s={},p}selectKeys(e,t){const i=this.clean();return e.forEach(n=>{h(i,this.setCheckedByIdReturnDiff(n,!0,t))}),i}getSelectKeys(){const e=[];return Object.values(this.map).forEach(t=>{t.checked&&e.push(t.id)}),e}calcParentStatus(){const{parent:e}=this;if(e==null)return this;const{childList:t}=e,{length:i}=t;if(i<=0)return this;a(e,u,f(e,c)),a(e,m,f(e,l));const n=t.filter(y=>y.checked).length;return n===i?(a(e,c,!0),a(e,l,!1)):n>0||t.some(y=>y.indeterminate)?(e.setIndeterminate(!0),a(e,c,!1)):(a(e,l,!1),a(e,c,!1)),e.diff()&&!e.indeterminate&&e.calcParentStatus(),this}clean(){const e={};return Object.values(this.map).forEach(t=>{let i=e[t.id];t.checked&&(i=i!=null?i:{},i.checked=!1),t.indeterminate&&(i=i!=null?i:{},i.indeterminate=!1),i&&(e[t.id]=i),a(t,u,a(t,c,!1)),a(t,m,a(t,l,!1))}),e}each(e){return this.childList.forEach((t,i)=>{e(t,this,i)}),this}eachDeep(e){return this.childList.forEach((t,i)=>{e(t,this,i),t.eachDeep(e)}),this}eachDeepAfter(e){return this.childList.forEach((t,i)=>{t.eachDeep(e),e(t,this,i)}),this}};let r=I;return c=new WeakMap,u=new WeakMap,l=new WeakMap,m=new WeakMap,r});
